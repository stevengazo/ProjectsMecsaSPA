@inject IDbContextFactory<ProjectsDBContext> DbContextFactory

<div class="card shadow-sm p-2 my-2">

    <div class="d-flex align-items-center justify-content-between gap-2">

        <div class="fw-semibold text-truncate">
            @Company.CompanyName
        </div>

        @if (CanEdit)
        {
            <EditForm Model="@Company"
                      OnValidSubmit="EditCompany"
                      class="d-flex align-items-center gap-2">
                <DataAnnotationsValidator />

                <InputText class="form-control form-control-sm shadow-sm"
                           style="max-width: 220px;"
                           @bind-Value="Company.CompanyName" />

                <button type="submit"
                        class="btn btn-sm btn-outline-success"
                        title="Guardar">
                    ✔
                </button>

                <button type="button"
                        class="btn btn-sm btn-outline-secondary"
                        title="Cancelar"
                        @onclick="() => CanEdit = false">
                    ✖
                </button>
            </EditForm>
        }
        else
        {
            <button class="btn btn-sm btn-outline-primary"
                    title="Editar"
                    @onclick="() => CanEdit = true">
                ✎
            </button>
        }
    </div>
</div>



@code {
    [Parameter]
    public Company Company { get; set; }

    ProjectsDBContext db;

    bool CanEdit { get; set; } = false;

	protected override async Task OnInitializedAsync()
	{
      db=  DbContextFactory.CreateDbContext();
		
	}

    async Task EditCompany()
    {
        if (Company != null && !string.IsNullOrEmpty(Company.CompanyName))
        {
            db.Company.Update(Company);
            await db.SaveChangesAsync();
            CanEdit = false;
        }
    }
}