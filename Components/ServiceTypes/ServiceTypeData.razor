@inject IDbContextFactory<ProjectsDBContext> DbContextFactory

<div class="card shadow-sm p-2 my-1">

    <div class="d-flex align-items-center justify-content-between gap-2">

        <div class="fw-semibold text-truncate">
            @TypeModelData.Name
        </div>

        @if (CanEdit)
        {
            <EditForm Model="@TypeModelData"
                      OnValidSubmit="EditTypeModel"
                      class="d-flex align-items-center gap-2">
                <DataAnnotationsValidator />

                <InputText class="form-control form-control-sm shadow-sm"
                           style="max-width: 220px;"
                           @bind-Value="TypeModelData.Name" />

                <button type="submit"
                        class="btn btn-sm btn-outline-success"
                        title="Guardar">
                    ✔
                </button>

                <button type="button"
                        class="btn btn-sm btn-outline-secondary"
                        title="Cancelar"
                        @onclick="() => CanEdit = false">
                    ✖
                </button>
            </EditForm>
        }
        else
        {
            <button class="btn btn-sm btn-outline-primary"
                    title="Editar"
                    @onclick="() => CanEdit = true">
                ✎
            </button>
        }
    </div>
</div>


@code {
    [Parameter]
    public TypeModel TypeModelData { get; set; }

    ProjectsDBContext db;

    bool CanEdit { get; set; } = false;

    protected override async Task OnInitializedAsync()
    {
        db = DbContextFactory.CreateDbContext();

    }

    async Task EditTypeModel()
    {
        if (TypeModelData != null && !string.IsNullOrEmpty(TypeModelData.Name))
        {
            db.Types.Update(TypeModelData);
            await db.SaveChangesAsync();
            CanEdit = false;
        }
    }
}