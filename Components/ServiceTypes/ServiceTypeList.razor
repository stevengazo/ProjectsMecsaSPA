@inject IDbContextFactory<ProjectsDBContext> DbContextFactory

<div class="border rounded shadow-sm p-3 mb-3">

    <h6 class="fw-bold mb-3">Agregar Servicio</h6>

    <EditForm Model="@typeModelObj">
        <div class="row g-2 align-items-end">

            <div class="col-md-6">
                <div class="form-floating">
                    <InputText id="ServiceName"
                               class="form-control form-control-sm shadow-sm"
                               @bind-Value="typeModelObj.Name" />
                    <label for="ServiceName">Nombre del Servicio</label>
                </div>
            </div>

            <div class="col-md-3">
                <button type="button"
                        class="btn btn-sm btn-outline-success w-100"
                        @onclick="AddTypeModelAsync">
                    Agregar
                </button>
            </div>

        </div>
    </EditForm>
</div>

<div class="mt-3">
    @foreach (var i in TypesModels)
    {
        <ServiceTypeData TypeModelData="i" />
    }
</div>


@code {
	List<TypeModel> TypesModels = new List<TypeModel>();
	ProjectsDBContext db;

	private TypeModel typeModelObj { get; set; }
	protected override async Task OnInitializedAsync()
	{
		db = DbContextFactory.CreateDbContext();
		typeModelObj = new();
		TypesModels = await db.Types.AsNoTracking().ToListAsync();
	}

	async Task AddTypeModelAsync()
	{
		if (!string.IsNullOrEmpty(typeModelObj.Name))
		{
			db.Types.Add(typeModelObj);
			db.SaveChanges();
			TypesModels.Add(typeModelObj);
			typeModelObj = new();
			StateHasChanged();
		}
	}
}
