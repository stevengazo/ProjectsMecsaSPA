@inject IDbContextFactory<ProjectsDBContext> DbContextFactory

<div>
	<h5>Agregar Servicio</h5>
	<div class="d-flex flex-row gap-1">
		<EditForm Model="@typeModelObj">
			<div class="form-floating">
		
				<InputText id="Name" class="form-control" @bind-Value="typeModelObj.Name" />
				<label for="Name">Nombre</label>
			</div>
		</EditForm>
		<button class="btn btn-primary btn-sm" @onclick="AddTypeModelAsync">Agregar</button>

	</div>
</div>

@foreach (var i in TypesModels)
{
	<ServiceTypeData TypeModelData="i" />
}

@code {
	List<TypeModel> TypesModels = new List<TypeModel>();
	ProjectsDBContext db;

	private TypeModel typeModelObj { get; set; }
	protected override async Task OnInitializedAsync()
	{
		db = DbContextFactory.CreateDbContext();
		typeModelObj = new();
		TypesModels = await db.Types.AsNoTracking().ToListAsync();
	}

	async Task AddTypeModelAsync()
	{
		if (!string.IsNullOrEmpty(typeModelObj.Name))
		{
			db.Types.Add(typeModelObj);
			db.SaveChanges();
			TypesModels.Add(typeModelObj);
			typeModelObj = new();
			StateHasChanged();
		}
	}
}
